# 线性代数之矩阵变换/矩阵乘法

下边这些知识注定是有一点枯燥的，哈哈，静下心来仔细读读，会有很大收获的...

> 参考链接：

1. [小谈矩阵和坐标变换](http://www.360doc.com/content/15/0720/17/6973384_486236702.shtml)
2. [线性变换/矩阵及乘法:图解线性代数](https://zhuanlan.zhihu.com/p/26591729)
3. [从坐标图中理解"空间变换"](http://www.cnblogs.com/lookof/p/3512358.html)
4. [矩阵变换坐标系 深入理解](https://zhuanlan.zhihu.com/p/23130870)
5. [基的变换与相似矩阵](https://zhuanlan.zhihu.com/p/25645667)
6. [工程数学线性代数第五版](http://vdisk.weibo.com/s/azO12wTKsB3zi)
7. [线性代数这么学 Linear Algebra Done Right](http://vdisk.weibo.com/s/uEPuGphTXE3UA)
8. 还有可以称为神作的<b>孟岩</b>大佬的理解矩阵三篇：
    * [理解矩阵(一)](http://blog.csdn.net/myan/article/details/647511)
    * [理解矩阵(二)](http://blog.csdn.net/myan/article/details/649018)
    * [理解矩阵(三)](http://blog.csdn.net/myan/article/details/1865397)

## 概述

线性变换是线性空间中的运动, 而矩阵就是用来描述这种变换的工具.

## 本质

谈到矩阵，就离不开坐标变换，而坐标变换的基础是来源于线性代数。

1. 线性空间中的<b>任何一个对象，通过选取基和坐标的办法，都可以表达为向量的形式</b>。这里只要把基看成是线性空间里的坐标系就可以了。在线性空间中选定基之后，向量刻画对象，矩阵刻画对象的运动，用矩阵与向量的乘法施加运动。所以，矩阵的本质是运动的描述。

2. 矩阵是线性空间中的线性变换的一个描述。在一个线性空间中，<b>只要我们选定一组基，那么对于任何一个线性变换，都能够用一个确定的矩阵来加以描述</b>。

3. 矩阵不仅可以作为线性变换的描述，而且可以作为一组基的描述。<b>而作为变换的矩阵，不但可以把线性空间中的一个点给变换到另一个点去，而且也能够把线性空间中的一个坐标系（基）表换到另一个坐标系（基）去</b>。而且，变换点与变换坐标系，具有异曲同工的效果。线性代数里最有趣的奥妙，就蕴含在其中。

## UnderStanding (理解)

### 第一种理解

我们先讨论 3 * 3 矩阵：

* 矩阵的行序和列序（也称行优先或列优先）仅仅是指矩阵的存储方式，即我们如果用一个 4 * 4 数组 m 存储矩阵，如果 m[0][0]-m[0][3] 连续存储了矩阵的第一行，那么就是行优先，反之就是列优先。无论是行优先还是列优先，它们代表的数学意义是相同的。

* 如果矩阵是行序，那么它的第一列（m[0][0],m[1][0],m[2][0]）就代表 X 变换，第二列就是 Y 变换，第三列就是 Z 变换。
  
我们来看看为什么：

刚才提到矩阵把线性空间中的一个点给变换到另一个点，不妨称变换前的点为 P1(x1,y1,z1)，变换后的点为 P2(x2,y2,z2）:

那么根据线代中的矩阵乘法，P1 * M = P2 展开就成了：

![P1*M=P2](/images/LinearAlgebra/LA_1.png)

所以：

x2 = x1*m[0][0] + y1*m[1][0] + z1*m[2][0];

y2 = x1*m[0][1] + y1*m[1][1] + z1*m[2][1];

z2 = x1*m[0][2] + y1*m[1][2] + z1*m[2][2];

看出什么了吗？

如果把一个行序矩阵（接下来讨论的都是行序矩阵，就省略行序二字了）的每一列分别用 X,Y,Z 三个矢量来表示，那么 M 就表示为： XYZ 三根轴。

现在，矩阵 M 看起来是不是很像一个坐标系？而 P1 到 P2 的变换就是 P1 分别与 X,Y,Z 的点积！

也就是矩阵 M 是把 P1 从老坐标系变换到新坐标系，而矩阵的三列（三根轴）就分别代表了新坐标系的三根轴在老坐标系中的坐标！

而点积的几何意义其实就是求取投影！所以坐标变换的几何本质（刚才已经讨论过其代数本质），就是把一个点分别投影到三根轴上去而已！

再仔细想一想，P1 在 XYZ 三根轴上的投影，不正是它在新坐标系下的坐标吗？这样一来，坐标变换是不是就太容易理解了呢？

* 所以缩放矩阵M的三根轴，XYZ 的模就不等于 1，如果某一根轴的模不等于 1，那么就有了对应的缩放。所以纯旋转矩阵，前三列的模必然等于 1。

* DX 的矩阵是行序，OpenGL 的矩阵是列序。我写的引擎，S3D 的矩阵也是行序的。

### 第 2 种理解

让我们从一个实际的例子入手：下图是一个用两维的笛卡尔坐标系表示的二维空间。

![LA_2](/images/LinearAlgebra/LA_2.gif)

其中，黑色坐标系 <b>x-y</b> 代表一个二维空间；蓝色坐标系 <b>i-j</b> 代表另外一个二维空间。已知蓝色坐标系轴在黑色坐标系下对应的值是 <b>i=(1,1), j=(-1,1)</b>，又知橙色向量 <b>p</b> 处在 <b>i-j</b> 空间中，其坐标值为 <b>(2,1)</b>。现在的问题是，这个 <b>p</b> 被转换到黑色坐标系 <b>x-y</b> 空间下它的坐标值是什么？
 
解决这个问题一个最关键也最直接的想法是“<b>向量分解与再合成</b>”。 <b>p</b> 可以被分解到 <b>i</b> 和 <b>j</b> 两个方向，得到 <b>p= 2i+j</b>；同时 <b>i</b> 又可以分解到 <b>x</b> 和 <b>y</b> 两个方向，得到 <b>i = x + y</b>，另外 <b>j</b> 也可以分解得到 <b>j = -x + y</b>。于是，我们全部展开，就得到 <b>p(i-j) = 2i + j = 2(x + y) + (-x + y) = x + 3y = p(x-y) </b>。因此点 <b>p</b> 在 <b>x-y</b> 空间下的坐标值为 <b>(1,3)</b>。

这种方法可以用来讨论更一般的情况。假设 <b>p</b> 点在 <b>i-j</b> 坐标系下为 <b>(k1,k2)</b>，在 <b>x-y</b> 坐标系下为 <b>(q1,q2)</b>。同样地有基向量 <b>i</b> 对应在 <b>x-y</b> 空间中为 <b>(m1,m2)</b>；<b>j</b> 对应在 <b>x-y</b> 空间中为 <b>(n1,n2)</b>。于是我们有以下推导，

![LA_3](/images/LinearAlgebra/LA_3.png)

其中 <b>(k1,k2)</b> 是 <b>i-j</b> 空间下的坐标值，而 <b>(q1,q2)</b> 是 <b>x-y</b> 空间下的坐标值。中间的矩阵就是用来做转换的矩阵。从中我们可以发现，如果竖着来观察，向量 <b>(m1,m2)</b> 就是基向量 <b>i</b> 在 <b>x-y</b> 空间下的坐标值，而向量 <b>(n1,n2)</b> 则是基向量 <b>j</b> 在 <b>x-y</b> 空间下的坐标值。这个矩阵，实际上就是由空间 <b>i-j</b> 下的基向量在空间 <b>x-y</b> 下的坐标值构成的。这一点，以前我就知道。但直到今天，我才理解了为什么是这样。
 
因为知道了底细，所以一些长久以来伴随的困惑也随之消解。比如，对于一个变换表达式 <b>M * v1</b>，<b>v1</b>究竟会被变换成什么样子，或者说什么空间内呢？这要由矩阵 <b>M</b> 决定：<b>M</b> 中的各基向量代表的是什么空间，这个 <b>v1</b> 就会被转换到什么空间。
 
这个结论可以很自然地扩推广到三维或者高维空间中，因为“向量分解与再合成”的规则在一般（欧几里得）几何学中是普遍适用的。
 
现在，麻麻再也不用担心我的“空间转换”能力啦。

## Idea (原理)

![LA_4](/images/LinearAlgebra/LA_4.png)

### 过渡矩阵 & 坐标变换

![LA_5](/images/LinearAlgebra/LA_5.jpg)